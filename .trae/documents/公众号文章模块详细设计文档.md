# 公众号文章模块详细设计文档

## 1. 模块概述

公众号文章模块负责展示"夏叶的AI加油站"微信公众号的文章内容，支持文章列表展示、搜索功能和文章详情查看，实现公众号内容的网站化展示。

## 2. 组件设计

### 2.1 组件结构

```
ArticlesPage.vue
├── ArticleSearch.vue        // 文章搜索组件
├── ArticleList.vue          // 文章列表组件
├── ArticleCard.vue          // 文章卡片组件
├── ArticleDetail.vue        // 文章详情组件
├── Pagination.vue           // 分页组件
└── LoadingState.vue         // 加载状态组件
```

### 2.2 组件详细设计

#### ArticleSearch.vue (文章搜索组件)
```typescript
// 组件功能：提供文章标题关键词搜索功能
// 创建日期：2024-12-19
// 参数：searchValue - 搜索关键词，onSearch - 搜索回调
// 返回值：Vue组件

interface ArticleSearchProps {
  searchValue: string;
  placeholder?: string;
  loading?: boolean;
}

interface ArticleSearchEmits {
  search: [keyword: string];
  clear: [];
}
```

#### ArticleList.vue (文章列表组件)
```typescript
// 组件功能：展示文章列表，支持分页和加载状态
// 创建日期：2024-12-19
// 参数：articles - 文章数组，loading - 加载状态
// 返回值：Vue组件

interface ArticleListProps {
  articles: Article[];
  loading?: boolean;
  hasMore?: boolean;
}

interface ArticleListEmits {
  loadMore: [];
  articleClick: [article: Article];
}
```

#### ArticleCard.vue (文章卡片组件)
```typescript
// 组件功能：展示单篇文章的卡片信息
// 创建日期：2024-12-19
// 参数：article - 文章对象
// 返回值：Vue组件

interface ArticleCardProps {
  article: Article;
  showSummary?: boolean;
  compact?: boolean;
}

interface ArticleCardEmits {
  click: [article: Article];
  share: [article: Article];
}
```

#### ArticleDetail.vue (文章详情组件)
```typescript
// 组件功能：展示文章详细内容
// 创建日期：2024-12-19
// 参数：articleId - 文章ID
// 返回值：Vue组件

interface ArticleDetailProps {
  articleId: string;
}

interface ArticleDetailState {
  article: Article | null;
  loading: boolean;
  error: string | null;
}
```

## 3. 数据结构

### 3.1 文章数据结构

```typescript
// 文章信息接口
interface Article {
  id: string;                  // 文章ID
  title: string;               // 文章标题
  summary: string;             // 文章摘要
  content: string;             // 文章内容（HTML格式）
  coverImage: string;          // 封面图片URL
  wechatUrl: string;           // 微信文章原链接
  publishedAt: string;         // 发布时间
  readCount?: number;          // 阅读数
  likeCount?: number;          // 点赞数
  tags?: string[];             // 文章标签
  author: string;              // 作者
  createdAt: string;           // 创建时间
  updatedAt: string;           // 更新时间
}
```

### 3.2 搜索和分页结构

```typescript
// 搜索参数接口
interface ArticleSearchParams {
  keyword?: string;            // 搜索关键词
  page: number;                // 页码
  pageSize: number;            // 每页数量
  sortBy?: 'publishedAt' | 'readCount' | 'likeCount';
  sortOrder?: 'asc' | 'desc';
}

// 分页响应接口
interface ArticleListResponse {
  articles: Article[];
  total: number;               // 总数量
  page: number;                // 当前页码
  pageSize: number;            // 每页数量
  totalPages: number;          // 总页数
  hasMore: boolean;            // 是否有更多
}

// 页面状态管理
interface ArticlesPageState {
  articles: Article[];
  searchKeyword: string;
  currentPage: number;
  totalPages: number;
  loading: boolean;
  error: string | null;
  hasMore: boolean;
}
```

## 4. API接口设计

### 4.1 获取文章列表

**接口地址：** `GET /api/articles`

**请求参数：**
| 参数名 | 类型 | 必需 | 描述 |
|--------|------|------|------|
| page | number | 否 | 页码，默认1 |
| pageSize | number | 否 | 每页数量，默认10 |
| keyword | string | 否 | 搜索关键词 |
| sortBy | string | 否 | 排序字段 |
| sortOrder | string | 否 | 排序方向 |

**响应数据：**
```json
{
  "articles": [
    {
      "id": "article-1",
      "title": "AI技术在教育领域的应用前景",
      "summary": "本文探讨了人工智能技术在现代教育中的应用...",
      "content": "<p>完整的HTML内容...</p>",
      "coverImage": "https://example.com/cover1.jpg",
      "wechatUrl": "https://mp.weixin.qq.com/s/xxx",
      "publishedAt": "2024-12-18T10:00:00Z",
      "readCount": 1500,
      "likeCount": 89,
      "tags": ["AI", "教育", "技术"],
      "author": "夏叶的AI加油站",
      "createdAt": "2024-12-18T10:00:00Z",
      "updatedAt": "2024-12-18T10:00:00Z"
    }
  ],
  "total": 120,
  "page": 1,
  "pageSize": 10,
  "totalPages": 12,
  "hasMore": true
}
```

### 4.2 获取文章详情

**接口地址：** `GET /api/articles/:id`

**请求参数：**
| 参数名 | 类型 | 必需 | 描述 |
|--------|------|------|------|
| id | string | 是 | 文章ID |

**响应数据：**
```json
{
  "article": {
    "id": "article-1",
    "title": "AI技术在教育领域的应用前景",
    "summary": "本文探讨了人工智能技术在现代教育中的应用...",
    "content": "<p>完整的HTML内容...</p>",
    "coverImage": "https://example.com/cover1.jpg",
    "wechatUrl": "https://mp.weixin.qq.com/s/xxx",
    "publishedAt": "2024-12-18T10:00:00Z",
    "readCount": 1500,
    "likeCount": 89,
    "tags": ["AI", "教育", "技术"],
    "author": "夏叶的AI加油站",
    "createdAt": "2024-12-18T10:00:00Z",
    "updatedAt": "2024-12-18T10:00:00Z"
  }
}
```

### 4.3 同步公众号文章

**接口地址：** `POST /api/articles/sync`

**请求参数：**
```json
{
  "forceSync": false,
  "limit": 50
}
```

**响应数据：**
```json
{
  "success": true,
  "message": "文章同步成功",
  "syncedCount": 5,
  "newArticles": 3,
  "updatedArticles": 2
}
```

### 4.4 搜索文章

**接口地址：** `GET /api/articles/search`

**请求参数：**
| 参数名 | 类型 | 必需 | 描述 |
|--------|------|------|------|
| q | string | 是 | 搜索关键词 |
| page | number | 否 | 页码 |
| pageSize | number | 否 | 每页数量 |

**响应数据：** 同文章列表接口

## 5. 页面交互逻辑

### 5.1 页面加载流程

1. 组件挂载时调用 `fetchArticles()` 方法
2. 根据路由参数设置搜索条件
3. 加载文章列表数据
4. 渲染文章卡片和分页组件

### 5.2 搜索功能

```typescript
// 搜索处理函数
const handleSearch = async (keyword: string) => {
  searchKeyword.value = keyword;
  currentPage.value = 1;
  loading.value = true;
  
  try {
    const response = await searchArticles({
      keyword,
      page: 1,
      pageSize: 10
    });
    
    articles.value = response.articles;
    totalPages.value = response.totalPages;
    hasMore.value = response.hasMore;
  } catch (error) {
    handleError(error);
  } finally {
    loading.value = false;
  }
};

// 清空搜索
const handleClearSearch = () => {
  searchKeyword.value = '';
  fetchArticles();
};
```

### 5.3 分页和加载更多

```typescript
// 分页处理
const handlePageChange = (page: number) => {
  currentPage.value = page;
  fetchArticles();
  // 滚动到顶部
  window.scrollTo({ top: 0, behavior: 'smooth' });
};

// 加载更多（无限滚动）
const handleLoadMore = async () => {
  if (!hasMore.value || loading.value) return;
  
  loading.value = true;
  currentPage.value += 1;
  
  try {
    const response = await fetchArticles({
      page: currentPage.value,
      keyword: searchKeyword.value
    });
    
    articles.value.push(...response.articles);
    hasMore.value = response.hasMore;
  } catch (error) {
    currentPage.value -= 1;
    handleError(error);
  } finally {
    loading.value = false;
  }
};
```

### 5.4 文章详情跳转

```typescript
// 文章点击处理
const handleArticleClick = (article: Article) => {
  // 跳转到文章详情页
  router.push(`/articles/${article.id}`);
};

// 跳转到微信原文
const handleViewOriginal = (wechatUrl: string) => {
  window.open(wechatUrl, '_blank');
};
```

## 6. 样式设计规范

### 6.1 文章列表布局

- **列表容器**：最大宽度1200px，居中对齐
- **文章卡片**：垂直列表布局，卡片间距16px
- **卡片内边距**：24px
- **卡片圆角**：8px
- **阴影效果**：`box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1)`

### 6.2 文章卡片设计

- **封面图片**：120px × 80px，圆角4px
- **标题字体**：18px，粗体，最多显示2行
- **摘要字体**：14px，常规，最多显示3行
- **元信息字体**：12px，灰色
- **标签样式**：小号标签，圆角背景

### 6.3 搜索框设计

- **搜索框宽度**：400px（桌面端），100%（移动端）
- **搜索框高度**：40px
- **圆角**：20px
- **图标**：搜索图标，16px
- **占位符**："搜索文章标题..."

## 7. 响应式设计

### 7.1 布局适配

- **桌面端**：文章卡片水平布局，图片在左，内容在右
- **平板端**：保持水平布局，调整间距和字体大小
- **移动端**：改为垂直布局，图片在上，内容在下

### 7.2 移动端优化

- 搜索框全宽显示
- 文章卡片简化显示
- 触摸友好的点击区域
- 优化滚动加载体验

## 8. 性能优化

### 8.1 列表虚拟化

- 长列表使用虚拟滚动
- 图片懒加载
- 分页或无限滚动

### 8.2 缓存策略

- 文章列表缓存15分钟
- 文章详情缓存1小时
- 搜索结果缓存5分钟
- 使用浏览器缓存减少重复请求

### 8.3 SEO优化

- 文章详情页支持SSR
- 合理的meta标签设置
- 结构化数据标记
- 友好的URL结构

## 9. 数据同步策略

### 9.1 自动同步

- 每日定时同步公众号最新文章
- 增量同步，只获取新发布的文章
- 同步失败时的重试机制

### 9.2 手动同步

- 管理员可手动触发同步
- 支持强制全量同步
- 同步进度和状态显示

## 10. 错误处理

### 10.1 网络错误

- 显示友好的错误提示
- 提供重试按钮
- 网络恢复后自动重试

### 10.2 内容错误

- 图片加载失败显示默认图片
- 内容格式异常的降级处理
- 缺失数据的默认值填充